<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Openbot</title>
    <style>
        /* Style for the message box */
        #messageTable {
            border: 1px solid #211c4e;
        }

        #messageBox {
            /* border: 1px solid #ddd; */
            /* Light gray border */
            /* background-color: #f4f4f4; */
            /* Light gray background */
            padding: 10px;
            /* Some padding inside the box */
            margin: 20px 0;
            /* Margin above and below the box */
            height: 150px;
            /* Fixed height */
            overflow-y: auto;
            /* Enable vertical scrolling if content overflows */
        }
    </style>
</head>

<body>
    <h2>Openbot Beta</h2>
    <div id="messageBox">
        <!-- Messages will be added here -->
        <table id="messageTable">
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>Level</th>
                    <th>Message</th>
                </tr>
            </thead>
            <tbody>
                <!-- Messages will be added here -->
            </tbody>
        </table>

    </div>

    <script>
        const ws = new WebSocket('ws://' + window.location.host);

        ws.onopen = function () {
            console.log('Connected to the server');
            //ws.send('Hello, server!');
        };

        ws.onmessage = function (event) {
            console.log('Message from server: ', event.data);

            // Attempt to parse the incoming message as JSON
            try {
                const logEntry = JSON.parse(event.data);

                // Create a new row and cells for the timestamp, level, and message
                const row = document.createElement('tr');
                const timestampCell = row.insertCell(0);
                const levelCell = row.insertCell(1);
                const messageCell = row.insertCell(2);

                // Assign the values to the cells
                timestampCell.textContent = logEntry.timestamp;
                levelCell.textContent = logEntry.level;
                messageCell.textContent = logEntry.message;

                // Append the new row to the table body
                const messageTableBody = document.querySelector('#messageTable tbody');
                messageTableBody.appendChild(row);
            } catch (e) {
                console.error('Error parsing message from server:', e);
            }
        };

        ws.onclose = function () {
            console.log('Disconnected from the server');
        };
    </script>
</body>

</html>